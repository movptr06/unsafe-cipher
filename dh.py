#!/usr/bin/env python3

import random

P = 454682793590772301892300334801542284503884197161666156514102923919079803595610398960192656057345934217324210288006085027749823556750624750725539261257123566566673086481160427304707069714717747514436093984869777183597276587384937593842070361304037224481604293200832964273909017957433745089497153039555713114760674565627181626566459713008562257572140942485742126268245408138156524937002493341328483107262346277186444780878013426311427250105483203661406575395818803992657529000802326901455848059260341397138552744679791953387417545408715818771335469679300436982827489556059090064796370759462710276450283055052949616679220995649338056114177
G = 3 

MAX = (2 ** 2049) - 1

def dh_keygen():
    private = random.randint(G, P)
    public = pow(G, private, P)
    return private, public

def dh_getkey(private, public):
    K = pow(public, private, P)
    K = K.to_bytes(256, byteorder="little")
    return K
