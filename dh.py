#!/usr/bin/env python3

import random

P = 29960779351185206075648210932742726704361761910723600678875128131796915421224914335703818328866298086889121891765416601241567086125754178570613202336217539817334830234850189560759735175494218129833467920919432168032048626814886246822889351358526730690268737512278585355893057134520850405127639180848246383605432991353124596230991776444201699268305822500765943683713930266948193775144177948942271421876209923498459817540305190159516228473490386441436031817725647449006247052290910191610108634567636765886496441812901668160424567487364901098158235819407764702370798645095764875834536364888256771566956171629121394180097
G = 3 

MAX = (2 ** 2049) - 1

def dh_keygen():
    private = random.randint(G, MAX)
    public = pow(G, private, P)
    return private, public

def dh_getkey(private, public):
    K = pow(public, private, P)
    K = K.to_bytes(256, byteorder="little")
    return K
