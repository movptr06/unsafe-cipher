#!/usr/bin/env python3

import random

P = 22646174097090436840312520558605065426605980591625844023456908449894124814826159774574618842170861883356213845166738913503545977765223275694321304894457816962797944794190893799514639963274821501982530247895634595444543511388893468945345129810522377893242986050849345449462366871480751366996633901053668120682621289422913833903134210284023999997754699412388646772466220247206181469493336367703495169400140395463895733050450112520967892560682638395743977657429432423329290520162435038850081183482100317309305314942012766862030650608215042371870826364533187654374989860626706461480816205917211720558859701991173613682689
G = 3 

MAX = (2 ** 2048) - 1

def dh_keygen():
    private = random.randint(G, MAX)
    public = pow(G, private, P)
    return private, public

def dh_getkey(private, public):
    K = pow(public, private, P)
    K = K.to_bytes(256, byteorder="little")
    return K
